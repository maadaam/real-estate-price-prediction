# Прогнозирование цен на недвижимость Avito

Проект машинного обучения для предсказания цен на квартиры в Санкт-Петербурге на основе данных с Avito. Включает парсинг данных, feature engineering, модель CatBoost, REST API на FastAPI и веб-интерфейс с готовой Docker-инфраструктурой для развертывания.

## Особенности проекта

- **Парсинг данных**: Сбор ~15,000 объявлений с Avito
- **Feature Engineering**: 50+ признаков включая геоданные, характеристики квартир и инфраструктуру
- **Модель**: CatBoostRegressor с оптимизацией гиперпараметров
- **Веб-интерфейс**: Интуитивный UI для предсказания цен
- **REST API**: Документированное API для интеграций
- **Docker**: Полностью контейнеризированное решение

## Быстрый старт

### Предварительные требования

#### 1. Установите Docker
- **Windows/Mac**: Скачайте и установите [Docker Desktop](https://www.docker.com/products/docker-desktop/)
- **Linux**: Выполните в терминале:
  ```bash
  sudo apt-get update
  sudo apt-get install docker.io docker-compose
  ```

#### 2. Проверьте установку
```bash
docker --version
docker-compose --version
```

### Установка и запуск

#### 1. Клонируйте репозиторий:
```bash
git clone https://github.com/ваш-username/avito-flats-ml-project
cd avito-flats-ml-project
```

#### 2. Запустите приложение:
```bash
docker-compose up
```

После запуска:
- **API сервер**: `http://localhost:8000`
- **Swagger UI документация**: `http://localhost:8000/docs`
- **Веб-интерфейс**: `http://localhost:8000`

## Веб-интерфейс

Интерфейс позволяет ввести параметры квартиры и получить прогноз цены:
- Форма ввода параметров (площадь, комнаты, метро и т.д.)

## Возможности

### Основные функции
- **Прогнозирование цены**: Примерная оценка стоимости квартиры в рублях
- **Геоанализ**: Учёт расположения относительно метро и инфраструктуры

### Технические особенности
- **Продвинутый препроцессинг**: Обработка пропусков, выбросов, feature engineering
- **Оптимизация модели**: GridSearchCV для подбора гиперпараметров

## Использование API

### 1. Прогнозирование цены одной квартиры

**POST запрос к `/predict`:**
```bash
curl -X 'POST' \
  'http://localhost:8000/predict' \
  -H 'Content-Type: application/json' \
  -d '{
    "площадь_общая": 65,
    "комнат": 2,
    "этаж": 5,
    "этажность_дома": 16,
    "время_до_ближайшего_мин": 15,
    "тип_дома": "панельный",
    "ремонт": "евро",
    "ближайшее_метро": "Академическая"
  }'
```

**Ответ:**
```json
{
  "predicted_price": 12500000,
  "confidence": 0.85,
  "price_range": [11800000, 13200000],
  "features_impact": {
    "площадь_общая": 0.35,
    "ближайшее_метро": 0.25,
    "ремонт": 0.15,
    "другие_факторы": 0.25
  }
}
```

```

## Модель и алгоритмы

### Архитектура решения

```
Парсинг Avito → Предобработка → Feature Engineering → CatBoost → API/Web
```

### Этапы обработки данных

#### 1. Feature Extraction
- Извлечение параметров из сырых данных
- Метро, количество комнат, студия, апартраменты, вид сделки и тд..

#### 2. Feature Engineering
- **Отношения**: Доли площадей, цена за м²
- **Категоризация**: Тип дома, возраст, высотность
- **Временные признаки**: Время до метро, наличие инфраструктуры
- **Статистические**: Средняя цена по метро, частотные признаки

#### 3. Обработка пропусков
- Медианное заполнение по группам
- Использование отношений (кухня/общая площадь)
- Каскадное заполнение с приоритетами

#### 4. Моделирование
- **Алгоритм**: CatBoostRegressor
- **Целевая переменная**: Логарифм цены


### Метрики производительности

```
Тренировочная выборка:
- RMSE (%): 15%

Тестовая выборка:
- RMSE (%): 23%
```


## Docker развертывание

### Команды docker-compose

```bash
# Запуск в фоновом режиме
docker-compose up -d

# Просмотр логов
docker-compose logs -f app

# Остановка всех контейнеров
docker-compose down

# Пересборка с обновлением зависимостей
docker-compose up --build
```


## Технологический стек

- **Python 3.9+** - основной язык
- **CatBoost** - градиентный бустинг
- **FastAPI** - веб-фреймворк
- **Docker** - контейнеризация
- **Pandas/NumPy** - обработка данных
- **Scikit-learn** - метрики и утилиты
- **playwright** - парсинг


## Дорожная карта

### Запланированные улучшения
- [ ] Сбор большего количества данных
- [ ] Добавление нейросетевых моделей
- [ ] Реализация A/B тестирования моделей
- [ ] Система рекомендаций похожих квартир
- [ ] Прогнозирование динамики цен